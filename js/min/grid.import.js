!function(e,r){"use strict";"function"==typeof define&&define.amd?define(["jquery","./grid.base","./jsonxml"],function(t){return r(t,e)}):"object"==typeof module&&module.exports?module.exports=function(t,e){return t=t||window,void 0===e&&(e="undefined"!=typeof window?require("jquery"):require("jquery")(t)),require("./grid.base"),require("./jsonxml"),r(e,t),e}:r(jQuery,e)}("undefined"!=typeof window?window:this,function(a,r){"use strict";var p=a.jgrid;a.jgrid.extend({jqGridImport:function(i){return i=a.extend({imptype:"xml",impstring:"",impurl:"",mtype:"GET",impData:{},xmlGrid:{config:"roots>grid",data:"roots>rows"},jsonGrid:{config:"grid",data:"data"},ajaxOptions:{}},i||{}),this.each(function(){function e(t,e){var r,i,o,s=a(e.xmlGrid.config,t)[0],e=a(e.xmlGrid.data,t)[0];if(xmlJsonClass.xml2json){for(o in r=xmlJsonClass.xml2json(s," "),r=a.parseJSON(r))r.hasOwnProperty(o)&&(i=r[o]);void 0!==i&&(e?(s=r.grid.datatype,r.grid.datatype="xmlstring",r.grid.datastr=t,a(n).jqGrid(i).jqGrid("setGridParam",{datatype:s})):a(n).jqGrid(i))}else(null!=p.defaults&&a.jgrid.isFunction(p.defaults.fatalError)?p.defaults.fatalError:alert)("xml2json or parse are not present")}function r(t,e){var r;t&&"string"==typeof t&&(r=(t=a.parseJSON(t))[e.jsonGrid.config],(t=t[e.jsonGrid.data])?(e=r.datatype,r.datatype="jsonstring",r.datastr=t,a(n).jqGrid(r).jqGrid("setGridParam",{datatype:e})):a(n).jqGrid(r))}var t,n=this;switch(i.imptype){case"xml":a.ajax(a.extend({url:i.impurl,type:i.mtype,data:i.impData,dataType:"xml",context:i,complete:function(t){!(t.status<300||304===t.status)||0===t.status&&4===t.readyState||(e(t.responseXML,this),a(n).triggerHandler("jqGridImportComplete",[t,this]),a.jgrid.isFunction(this.importComplete)&&this.importComplete(t))}},i.ajaxOptions));break;case"xmlstring":i.impstring&&"string"==typeof i.impstring&&(t=a.parseXML(i.impstring))&&(e(t,i),a(n).triggerHandler("jqGridImportComplete",[t,i]),a.jgrid.isFunction(i.importComplete)&&i.importComplete(t),i.impstring=null);break;case"json":a.ajax(a.extend({url:i.impurl,type:i.mtype,data:i.impData,dataType:"json",context:i,complete:function(t){try{!(t.status<300||304===t.status)||0===t.status&&4===t.readyState||(r(t.responseText,this),a(n).triggerHandler("jqGridImportComplete",[t,this]),a.jgrid.isFunction(this.importComplete)&&this.importComplete(t))}catch(t){}}},i.ajaxOptions));break;case"jsonstring":i.impstring&&"string"==typeof i.impstring&&(r(i.impstring,i),a(n).triggerHandler("jqGridImportComplete",[i.impstring,i]),a.jgrid.isFunction(i.importComplete)&&i.importComplete(i.impstring),i.impstring=null)}})},jqGridExport:function(r){r=a.extend({exptype:"xmlstring",root:"grid",ident:"\t"},r||{});var i=null;return this.each(function(){if(this.grid){var t,e=a.extend(!0,{},a(this).jqGrid("getGridParam"));if(e.rownumbers&&(e.colNames.splice(0,1),e.colModel.splice(0,1)),e.multiselect&&(e.colNames.splice(0,1),e.colModel.splice(0,1)),e.subGrid&&(e.colNames.splice(0,1),e.colModel.splice(0,1)),e.knv=null,e.treeGrid)for(t in e.treeReader)e.treeReader.hasOwnProperty(t)&&(e.colNames.splice(e.colNames.length-1),e.colModel.splice(e.colModel.length-1));switch(r.exptype){case"xmlstring":i="<"+r.root+">"+xmlJsonClass.json2xml(e,r.ident)+"</"+r.root+">";break;case"jsonstring":i="{"+xmlJsonClass.toJson(e,r.root,r.ident,!1)+"}",void 0!==e.postData.filters&&(i=(i=i.replace(/filters":"/,'filters":')).replace(/\}\]\}"/,"}]}"))}}}),i},excelExport:function(e){return e=a.extend({exptype:"remote",url:null,oper:"oper",tag:"excel",exportOptions:{}},e||{}),this.each(function(){var t;this.grid&&"remote"===e.exptype&&((t=a.extend({},this.p.postData,e.exportOptions))[e.oper]=e.tag,r.location=e.url+(null!=e.url&&0<=e.url.indexOf("?")?"&":"?")+a.param(t))})}})});
//# sourceMappingURL=grid.import.js.map