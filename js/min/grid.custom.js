!function(t,r){"use strict";"function"==typeof define&&define.amd?define(["jquery","./grid.base","./jquery.fmatter","./grid.common"],function(e){return r(e,t.document)}):"object"==typeof module&&module.exports?module.exports=function(e,t){return e=e||window,void 0===t&&(t="undefined"!=typeof window?require("jquery"):require("jquery")(e)),require("./grid.base"),require("./jquery.fmatter"),require("./grid.common"),r(t,e.document),t}:r(jQuery,t.document)}("undefined"!=typeof window?window:this,function(U,L){"use strict";var W=U.jgrid,$=W.jqID,n=U.fn.jqGrid,J=n.getGuiStyles,t=n.getGridRes;W.extend({getColProp:function(e){var t=this[0];return null!=t&&t.grid&&void 0!==(e=t.p.iColByName[e])?t.p.colModel[e]:{}},setColProp:function(r,a){return this.each(function(){var e,t=this.p;this.grid&&null!=t&&a&&void 0!==(e=t.iColByName[r])&&U.extend(!0,t.colModel[e],a)})},sortGrid:function(d,c,u){return this.each(function(){var e,t,r,a=this,i=a.grid,o=a.p,l=o.colModel,s=l.length,n=!1;if(i)for(d=d||o.sortname,"boolean"!=typeof c&&(c=!1),t=0;t<s;t++)if((e=l[t]).index===d||e.name===d){(n=!0===o.frozenColumns&&!0===e.frozen?i.fhDiv.find("#"+$(o.id+"_"+d)):n)&&0!==n.length||(n=i.headers[t].el),"boolean"==typeof(r=e.sortable)&&!r||a.sortData(e.index||e.name,t,c,u,n);break}})},clearBeforeUnload:function(){return this.each(function(){var e,t=this,r=t.p,a=t.grid,i=W.clearArray,o=Object.prototype.hasOwnProperty;U.jgrid.isFunction(a.emptyRows)&&a.emptyRows.call(t,!0,!0),U(L).off("mousemove.jqGrid mouseup.jqGrid"+r.id),U(t).off();for(var l=a.headers.length,s=0;s<l;s++)a.headers[s].el=null;for(e in a)a.hasOwnProperty(e)&&(a.propOrMethod=null);var n=["formatCol","sortData","updatepager","refreshIndex","setHeadCheckBox","constructTr","clearToolbar","fixScrollOffsetAndhBoxPadding","rebuildRowIndexes","modalAlert","toggleToolbar","triggerToolbar","formatter","addXmlData","addJSONData","ftoolbar","_inlinenav","nav","grid","p"],l=n.length;for(s=0;s<l;s++)o.call(t,n[s])&&(t[n[s]]=null);t._index={},i(r.data),i(r.lastSelectedData),i(r.selarrrow),i(r.savedRow),r.editingInfo={}})},GridDestroy:function(){return this.each(function(){var e=this,t=e.p;if(e.grid&&null!=t){t.pager&&U(t.pager).remove();try{U("#alertmod_"+$(t.id)).remove(),U(e).jqGrid("clearBeforeUnload"),U(t.gBox).remove()}catch(e){}}})},GridUnload:function(){return this.each(function(){var e=this,t=U(e),r=e.p,a=U.fn.jqGrid;e.grid&&(t.removeClass(a.getGuiStyles.call(t,"grid","ui-jqgrid-btable")),r.pager&&(r.pager.substr(1,U.jgrid.uidPref.length)===U.jgrid.uidPref?U(r.pager).remove():U(r.pager).empty().removeClass(a.getGuiStyles.call(t,"pager.pager","ui-jqgrid-pager "+a.getGuiStyles.call(t,"bottom"))).removeAttr("style").removeAttr("dir")),t.jqGrid("clearBeforeUnload"),t.removeAttr("style").removeAttr("tabindex").removeAttr("role").removeAttr("aria-labelledby").removeAttr("style"),t.empty(),t.insertBefore(r.gBox).show(),U(r.pager).insertBefore(r.gBox).show(),U(r.gBox).remove())})},setGridState:function(s){return this.each(function(){var e,t=this,r=t.p,a=t.grid,i=a.cDiv,o=U(a.uDiv),l=U(a.ubDiv);a&&null!=r&&(e=(a=function(e){return n.getIconRes.call(t,"gridMinimize."+e)})("visible"),a=a("hidden"),"hidden"===s?(U(".ui-jqgrid-bdiv, .ui-jqgrid-hdiv",r.gView).slideUp("fast"),r.pager&&U(r.pager).slideUp("fast"),r.toppager&&U(r.toppager).slideUp("fast"),!0===r.toolbar[0]&&("both"===r.toolbar[1]&&l.slideUp("fast"),o.slideUp("fast")),r.footerrow&&U(".ui-jqgrid-sdiv",r.gBox).slideUp("fast"),U(".ui-jqgrid-titlebar-close span",i).removeClass(e).addClass(a),r.gridstate="hidden"):"visible"===s&&(U(".ui-jqgrid-hdiv, .ui-jqgrid-bdiv",r.gView).slideDown("fast"),r.pager&&U(r.pager).slideDown("fast"),r.toppager&&U(r.toppager).slideDown("fast"),!0===r.toolbar[0]&&("both"===r.toolbar[1]&&l.slideDown("fast"),o.slideDown("fast")),r.footerrow&&U(".ui-jqgrid-sdiv",r.gBox).slideDown("fast"),U(".ui-jqgrid-titlebar-close span",i).removeClass(a).addClass(e),r.gridstate="visible"))})},filterToolbar:function(e){return this.each(function(){var q,g,D,x,G,S,z,m,F,O,T,f,v,s,k,_,R,H,V,I,A,B=this,b=B.grid,M=U(B),P=B.p,N=W.info_dialog,E=W.htmlEncode;this.ftoolbar||(q=U.extend(!0,{autosearch:!0,autosearchDelay:500,searchOnEnter:!0,beforeSearch:null,afterSearch:null,beforeClear:null,afterClear:null,searchurl:"",sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:P.prmNames.filters,stringResult:!1,groupOp:"AND",defaultSearch:"bw",idMode:"new",searchOperators:!1,resetIcon:"&times;",applyLabelClasses:!0,loadFilterDefaults:!0,operands:{eq:"==",ne:"!",lt:"<",le:"<=",gt:">",ge:">=",bw:"^",bn:"!^",in:"=",ni:"!=",ew:"|",en:"!@",cn:"~",nc:"!~",nu:"#",nn:"!#"}},W.search,P.searching||{},e||{}),g=P.colModel,x=(D=function(e){return t.call(M,e)})("errors.errcap"),G=D("edit.bClose"),S=D("edit.msg"),z=J.call(B,"states.hover"),m=J.call(B,"states.select"),F=J.call(B,"filterToolbar.dataField"),O={},T=function(e){var t="gs_";switch(q.idMode){case"compatibility":t+=P.idPrefix;break;case"new":t+=P.id+"_"}return t+e},f=function(e){return"#"+$(T(e))},v=function(e){e=(e.value||"").split(":");return{on:e[0]||"on",off:e[1]||"off"}},s=function(e){var t,r,a,i,o,l,s=P.postData[q.sFilter],n={},d=P.iColByName;if(e)for(r=0;r<g.length;r++)!1!==(o=g[r]).search&&(l=o.searchoptions||{},n[o.name]={op:l.sopt?l.sopt[0]:"select"===o.stype||"checkbox"===o.stype?"eq":q.defaultSearch,data:void 0!==l.defaultValue?l.defaultValue:""});if(s&&P.search){if("string"==typeof s)try{s=U.parseJSON(s)}catch(e){s={}}else s=s||{};if(a=s.rules||{},!(null==s||null!=s.groupOp&&null!=q.groupOp&&s.groupOp.toUpperCase()!==q.groupOp.toUpperCase()||null==a||0===a.length||null!=s.groups&&0<s.groups.length))for(r=0;r<a.length;r++)for(i=a[r],o=g[d[i.field]],t=0;t<g.length;t++)if(((o=g[t]).index||o.name)===i.field&&!1!==o.search){if((l=o.searchoptions||{}).sopt){if(U.inArray(i.op,l.sopt)<0)continue}else if("select"===o.stype||"checkbox"===o.stype){if("eq"!==i.op)continue}else if(i.op!==q.defaultSearch)continue;n[o.name]={op:i.op,data:i.data}}}return n},k=function(e,t){switch(t){case 1:e.data("state",1).prop({checked:!0,indeterminate:!1});break;case 0:e.data("state",0).prop({checked:!1,indeterminate:!1});break;default:e.data("state",-1).prop({checked:!1,indeterminate:!0})}},_=function(){var r,a,e,u={},h=0,p={},t=(U.each(g,function(){function e(e){var t=l("thousandsSeparator").replace(/([\.\*\_\'\(\)\{\}\+\?\\])/g,"\\$1");return e.replace(new RegExp(t,"g"),"")}var t,a=this,r=a.index||a.name,i=a.searchoptions||{},o=U(f(a.name),!0===a.frozen&&!0===P.frozenColumns?b.fhDiv:b.hDiv),l=function(e,t){var r=a.formatoptions||{};return void 0!==r[e]?r[e]:D("formatter."+(t||a.formatter)+"."+e)},s=q.searchOperators?o.parent().prev().children("a").data("soper")||q.defaultSearch:i.sopt?i.sopt[0]:"select"===a.stype||"checkbox"===a.stype?"eq":q.defaultSearch;if("custom"===a.stype&&U.jgrid.isFunction(i.custom_value)&&0<o.length&&"SPAN"===o[0].nodeName.toUpperCase())t=i.custom_value.call(B,o.children(".customelement").first(),"get");else if("select"===a.stype)t=o.prop("multiple")?null==(t=o.val())||0===t.length?"":t.join(P.inFilterSeparator||","):o.val();else if("checkbox"===a.stype){var n=v(i);switch(o.data("state")){case-1:t="";break;case 0:t=n.off;break;default:t=n.on}}else switch(t=U.jgrid.trim(o.val()),a.formatter){case"integer":""!==(t=e(t).replace(l("decimalSeparator","number"),"."))&&(t=String(parseInt(t,10)));break;case"number":""!==(t=e(t).replace(l("decimalSeparator"),"."))&&"0"===String(t).charAt(0)&&(t=String(parseFloat(t)));break;case"currency":var d=l("prefix"),c=l("suffix");d&&d.length&&t.substr(0,d.length)===d&&(t=t.substr(d.length)),""!==(t=e(t=c&&c.length&&t.length>c.length&&t.substr(t.length-c.length,c.length)===c?t.substr(0,t.length-c.length):t).replace(l("decimalSeparator"),"."))&&(t=String(parseFloat(t)))}if(t||"nu"===s||"nn"===s||0<=U.inArray(s,P.customUnaryOperations))u[r]=t,p[r]=s,h++;else if(u.hasOwnProperty(r)&&delete u[r],!q.stringResult&&!q.searchOperators&&"local"!==P.datatype)try{null!=P.postData&&P.postData.hasOwnProperty(r)&&delete P.postData[r]}catch(e){}}),0<h),i=(q.stringResult||q.searchOperators||"local"===P.datatype?(r='{"groupOp":"'+q.groupOp+'","rules":[',a=0,U.each(u,function(e,t){0<a&&(r+=","),r=(r=(r+='{"field":"'+e+'",')+'"op":"'+p[e]+'",')+'"data":"'+(t+="").replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}',a++}),r+="]}",P.postData[q.sFilter]=r,U.each([q.sField,q.sValue,q.sOper],function(e,t){P.postData.hasOwnProperty(t)&&delete P.postData[t]})):U.extend(P.postData,u),P.searchurl&&(e=P.url,M.jqGrid("setGridParam",{url:P.searchurl})),"stop"===M.triggerHandler("jqGridToolbarBeforeSearch"));(i=!i&&U.jgrid.isFunction(q.beforeSearch)?q.beforeSearch.call(B):i)||M.jqGrid("setGridParam",{search:t}).trigger("reloadGrid",[U.extend({page:1},q.reloadGridSearchOptions||{})]),e&&M.jqGrid("setGridParam",{url:e}),M.triggerHandler("jqGridToolbarAfterSearch"),U.jgrid.isFunction(q.afterSearch)&&q.afterSearch.call(B)},R=D("search.odata")||[],H=P.customSortOperations,I=[],A=U("<tr></tr>",{class:"ui-search-toolbar",role:"row form"}),q.loadFilterDefaults&&(O=s()||{}),U.each(g,function(e){var s,t,r,a,i,o,l,n,d,c=this,u="filter",h=c.searchoptions||{},p=c.editoptions||{},f=U("<th></th>",{class:J.call(B,"colHeaders","ui-th-column ui-th-"+P.direction+" "+(q.applyLabelClasses&&c.labelClasses||"")),role:"gridcell","aria-describedby":P.id+"_"+c.name}),g=U("<div></div>"),m=U("<table class='ui-search-table'><tbody><tr><td class='ui-search-oper'></td><td class='ui-search-input'></td><td class='ui-search-clear' style='width:1px'></td></tr></tbody></table>"),v=m.children("tbody").children("tr").children("td"),b=v.eq(0),y=v.eq(1),v=v.eq(2);if(!0===this.hidden&&f.css("display","none"),this.search=!1!==this.search,void 0===this.stype&&(this.stype="text"),s=U.extend({mode:u,name:c.name,cm:c,iCol:e,id:T(c.name)},h),this.search){if(q.searchOperators){for(r=P.search&&null!=O[this.name]?O[this.name].op:s.sopt?s.sopt[0]:"select"===c.stype||"checkbox"===c.stype?"eq":q.defaultSearch,a=0;a<R.length;a++)if(R[a].oper===r){t=q.operands[r]||"";break}if(void 0===t&&null!=H)for(i in H)if(H.hasOwnProperty(i)&&i===r){t=H[i].operand;break}void 0===t&&(t="="),b.append("<a title='"+(null!=s.searchtitle?s.searchtitle:D("search.operandTitle"))+"' data-soper='"+r+"' class='"+J.call(B,"searchToolbar.operButton","soptclass")+"' data-colname='"+this.name+"'>"+E(t)+"</a>")}switch(b.data("colindex",e),null!=s.sopt&&1!==s.sopt.length||b.hide(),P.search&&null!=O[this.name]&&(s.defaultValue=O[this.name].data),void 0===s.clearSearch&&(s.clearSearch="text"===this.stype),s.clearSearch?(o=U.jgrid.isFunction(q.resetTitle)?q.resetTitle.call(B,{options:q,cm:c,cmName:c.name,iCol:e}):(D("search.resetTitle")||"Clear Search Value")+" "+W.stripHtml(P.colNames[e]),v.append("<a title='"+o+"' aria-label='"+o+"' class='"+J.call(B,"searchToolbar.clearButton","clearsearchclass")+"'><span>"+q.resetIcon+"</span></a>")):v.hide(),g.append(m),this.stype){case"checkbox":var w=void 0!==s.defaultValue?s.defaultValue:"-1",j=U("<input role='search' type='checkbox' class='"+F+"' name='"+(c.index||c.name)+"' id='"+T(c.name)+"' aria-labelledby='jqgh_"+P.id+"_"+c.name+"' data-state='"+w+"'/>");"-1"===w?j.prop("indeterminate",!0):"1"===w&&j.prop("checked",!0),j.click(function(){var e=U(this);switch(e.data("state")){case-1:k(e,1);break;case 0:k(e,-1);break;default:k(e,0)}!0===q.autosearch&&_()}),y.append(j),s.attr&&j.attr(s.attr),I.push({elem:j[0],options:s});break;case"select":(w=this.surl||s.dataUrl)?U.ajax(U.extend({url:w,context:{$tdInput:y,options:s,cm:c,iCol:e},dataType:"html",success:function(e,t,r){var a=this.cm,i=this.iCol,o=this.options,l=this.$tdInput;void 0!==o.buildSelect?(r=o.buildSelect.call(B,e,r,a,i))&&l.append(r):l.append(e),(r=l.children("select")).attr({name:a.index||a.name,id:T(a.name)}),o.attr&&r.attr(o.attr),r.addClass(F),r.css({width:"100%"}),0===r.find("option[value='']").length&&"string"==typeof s.noFilterText&&((e=L.createElement("option")).value="",e.innerHTML=s.noFilterText,r.prepend(e),null!=U(r[0].options[r[0].selectedIndex]).attr("selected")||r[0].multiple||(r[0].selectedIndex=0)),r[0].multiple&&0===r.find("option[selected]").length&&-1!==r[0].selectedIndex&&(r[0].options[r[0].selectedIndex].selected=!1),void 0!==o.defaultValue&&r.val(o.defaultValue),W.bindEv.call(B,r[0],o),W.fullBoolFeedback.call(B,o.selectFilled,"jqGridSelectFilled",{elem:r[0],options:o,cm:a,cmName:a.name,iCol:i,mode:u}),!0===q.autosearch&&r.change(function(){return _(),!1})}},W.ajaxOptions,P.ajaxSelectOptions||{})):(c.searchoptions?(l=void 0===h.value?p.value||"":h.value,n=void 0===h.separator?p.separator||":":h.separator,d=void 0===h.delimiter?p.delimiter||";":h.delimiter):c.editoptions&&(l=void 0===p.value?"":p.value,n=void 0===p.separator?":":p.separator,d=void 0===p.delimiter?";":p.delimiter),(l=h.generateValue&&null!=P.indexByColumnData[c.name]?B.generateValueFromColumnIndex(c.name,n,d):l)&&((w=L.createElement("select")).style.width="100%",j=U(w).attr({name:c.index||c.name,role:"search",id:T(c.name),"aria-describedby":P.id+"_"+c.name}),s.attr&&j.attr(s.attr),W.fillSelectOptions(w,l,n,d,null!=s.attr&&s.attr.multiple)||"string"!=typeof s.noFilterText||((l=L.createElement("option")).value="",l.innerHTML=s.noFilterText,l.selected=!0,j.prepend(l)),void 0!==s.defaultValue&&j.val(s.defaultValue),j.addClass(F),I.push({elem:w,options:s}),y.append(w),W.fullBoolFeedback.call(B,s.selectFilled,"jqGridSelectFilled",{elem:w,options:c.searchoptions||p,cm:c,cmName:c.name,iCol:e,mode:u}),!0===q.autosearch)&&j.change(function(){return _(),!1}));break;case"text":j=U("<input role='search' type='text' class='"+F+"' name='"+(c.index||c.name)+"' id='"+T(c.name)+"' aria-labelledby='jqgh_"+P.id+"_"+c.name+"' value='"+(void 0!==s.defaultValue?s.defaultValue:"")+"'/>"),y.append(j),c.createColumnIndex&&s.generateDatalist&&(n="dl_"+T(c.name),null!=(d=M.jqGrid("generateDatalistFromColumnIndex",c.name)))&&0<d.length&&(j.attr("list",n),y.append(d.attr("id",n))),s.attr&&j.attr(s.attr),I.push({elem:j[0],options:s}),!0===q.autosearch&&(q.searchOnEnter?j.keypress(function(e){return 13===(e.charCode||e.keyCode||0)?(_(),!1):this}):j.keydown(function(e){switch(e.which){case 13:return!1;case 9:case 16:case 37:case 38:case 39:case 40:case 27:break;default:V&&clearTimeout(V),V=setTimeout(function(){_()},q.autosearchDelay)}}));break;case"custom":y.append("<span style='width:100%;padding:0;box-sizing:border-box;' name='"+(c.index||c.name)+"' id='"+T(c.name)+"'/>");try{if(!U.jgrid.isFunction(s.custom_element))throw"e1";var C=s.custom_element.call(B,void 0!==s.defaultValue?s.defaultValue:"",s);if(!C)throw"e2";C=U(C).addClass("customelement"),g.find("span[name='"+(c.index||c.name)+"']").append(C)}catch(e){"e1"===e&&N.call(B,x,"function 'custom_element' "+S.nodefined,G),"e2"===e?N.call(B,x,"function 'custom_element' "+S.novalue,G):N.call(B,x,"string"==typeof e?e:e.message,G)}}}f.append(g),f.find(".ui-search-oper .soptclass,.ui-search-clear .clearsearchclass").hover(function(){U(this).addClass(z)},function(){U(this).removeClass(z)}),A.append(f),q.searchOperators||b.hide()}),U(b.hDiv).find(">div>.ui-jqgrid-htable>thead").append(A),U.each(I,function(){W.bindEv.call(B,this.elem,this.options)}),q.searchOperators&&(U(".soptclass",A).click(function(e){var t=U(this).offset(),r=t.left,t=t.top,a=this,i=(U("#sopt_menu").remove(),r=parseInt(r,10),t=parseInt(t,10)+18,0),o=[],l=U(a).data("soper"),s=U(a).data("colname"),n=U(".ui-jqgrid-view").css("font-size")||"11px",d="<ul id='sopt_menu' class='"+J.call(B,"searchToolbar.menu","ui-search-menu")+"' role='menu' tabindex='0' style='z-index:9999;display:block;font-size:"+n+";left:"+r+"px;top:"+t+"px;'>",i=P.iColByName[s];if(void 0!==i){var c,u,h,p,n=g[i],f=U.extend({},n.searchoptions);for(f.sopt||(f.sopt=[],f.sopt[0]="select"===n.stype||"checkbox"===n.stype?"eq":q.defaultSearch),U.each(R,function(){o.push(this.oper)}),null!=H&&U.each(H,function(e){o.push(e)}),i=0;i<f.sopt.length;i++)u=f.sopt[i],-1!==(c=U.inArray(u,o))&&(void 0!==(c=R[c])?(h=q.operands[u],p=c.text):null!=H&&(h=(c=H[u]).operand,p=c.text),d+='<li class="'+J.call(B,"searchToolbar.menuItem","ui-jqgrid-menu-item "+(l===u?m:""))+'" role="presentation"><a class="'+J.call(B,"searchToolbar.menuItemButton","g-menu-item")+'" tabindex="0" role="menuitem" value="'+E(u)+'" data-oper="'+E(h)+'"><table><tr><td style="width:25px">'+E(h)+"</td><td>"+E(p)+"</td></tr></table></a></li>");d+="</ul>",U("body").append(d),U("#sopt_menu > li > a").hover(function(){U(this).addClass(z)},function(){U(this).removeClass(z)}).click(function(){var e=U(this).attr("value"),t=U(this).data("oper");M.triggerHandler("jqGridToolbarSelectOper",[e,t,a]),U("#sopt_menu").hide(),U(a).data("soper",e).text(t),!0===q.autosearch&&(t=U(a).parent().next().children()[0],U(t).val()||"nu"===e||"nn"===e||0<=U.inArray(e,P.customUnaryOperations))&&_()})}e.stopPropagation()}),U("body").on("click",function(e){"soptclass"!==e.target.className&&U("#sopt_menu").hide()})),U(".clearsearchclass",A).click(function(){var e=U(this).closest(".ui-search-clear"),t=e.siblings(".ui-search-oper"),r=t.children("a"),a=r.data("soper"),t=parseInt(t.data("colindex"),10),i=e.siblings(".ui-search-input"),e=g[t],t=U.extend({},e.searchoptions||{}),o=t.defaultValue||"";switch(e.stype){case"select":o?i.find("select").val(o):i.find("select")[0].selectedIndex=0;break;case"checkbox":k(i.find("input[type=checkbox]"),-1);break;default:i.find("input").val(o)}("nu"===a||"nn"===a||0<=U.inArray(a,P.customUnaryOperations))&&(a=t.sopt?t.sopt[0]:"select"===e.stype||"checkbox"===e.stype?"eq":q.defaultSearch,t=null!=H&&null!=H[a]?H[a].operand:q.operands[a]||"",r.data("soper",a).text(t)),!0===q.autosearch&&_()}),B.ftoolbar=!0,B.triggerToolbar=_,B.clearToolbar=function(e){var o,r,a,t,l={},s=0,i=(e="boolean"!=typeof e||e,U.each(g,function(){var t,r,e=this,a=U(f(e.name),!0===e.frozen&&!0===P.frozenColumns?b.fhDiv:b.hDiv),i=e.searchoptions||{};switch(void 0!==i.defaultValue&&(t=i.defaultValue),o=e.index||e.name,e.stype){case"checkbox":k(a,-1);break;case"select":if(r=!(0<a.length&&a[0].multiple),a.find("option").each(function(e){if(this.selected=0===e&&r,U(this).val()===t)return!(this.selected=!0)}),void 0!==t)l[o]=t,s++;else try{delete P.postData[o]}catch(e){}break;case"text":if(a.val(t||""),void 0!==t)l[o]=t,s++;else try{delete P.postData[o]}catch(e){}break;case"custom":U.jgrid.isFunction(i.custom_value)&&0<a.length&&"SPAN"===a[0].nodeName.toUpperCase()&&(void 0===t&&(t=""),i.custom_value.call(B,a.children(".customelement").first(),"set",t))}}),0<s),n=(P.resetsearch=!0,q.stringResult||q.searchOperators||"local"===P.datatype?(r='{"groupOp":"'+q.groupOp+'","rules":[',a=0,U.each(l,function(e,t){0<a&&(r+=","),r=(r=r+'{"field":"'+e+'","op":"eq",')+'"data":"'+(t+="").replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}',a++}),r+="]}",P.postData[q.sFilter]=r,U.each([q.sField,q.sValue,q.sOper],function(e,t){P.postData.hasOwnProperty(t)&&delete P.postData[t]})):U.extend(P.postData,l),P.searchurl&&(t=P.url,M.jqGrid("setGridParam",{url:P.searchurl})),"stop"===M.triggerHandler("jqGridToolbarBeforeClear"));(n=!n&&U.jgrid.isFunction(q.beforeClear)?q.beforeClear.call(B):n)||e&&M.jqGrid("setGridParam",{search:i}).trigger("reloadGrid",[U.extend({page:1},q.reloadGridResetOptions||{})]),t&&M.jqGrid("setGridParam",{url:t}),M.triggerHandler("jqGridToolbarAfterClear"),U.jgrid.isFunction(q.afterClear)&&q.afterClear.call(B)},B.toggleToolbar=function(){var e=U("tr.ui-search-toolbar",b.hDiv),t=!0===P.frozenColumns&&U("tr.ui-search-toolbar",b.fhDiv);"none"===e.css("display")?(e.show(),t&&t.show()):(e.hide(),t&&t.hide()),!0===P.frozenColumns&&(M.jqGrid("destroyFrozenColumns"),M.jqGrid("setFrozenColumns"))},!0===P.frozenColumns&&(M.jqGrid("destroyFrozenColumns"),M.jqGrid("setFrozenColumns")),M.on("jqGridRefreshFilterValues.filterToolbar"+(q.loadFilterDefaults?" jqGridAfterLoadComplete.filterToolbar":""),function(){var e,t,r,a,i,o,l=s(!0)||{};if(q.stringResult||q.searchOperators||"local"===P.datatype||!P.search){for(e in l)l.hasOwnProperty(e)&&(a=l[e],o=(i=U(f(e))).closest("th.ui-th-column"),0<i.length)&&0<o.length&&(o=(P.colModel[o[0].cellIndex]||{}).searchoptions||{},"SELECT"===i[0].tagName.toUpperCase()&&i[0].multiple?i.val(a.data.split(P.inFilterSeparator||",")):i.is("input[type=checkbox]")?(r=v(o),k(i,a.data===r.on?1:a.data===r.off?0:-1)):0<i.find(".customelement").length&&U.jgrid.isFunction(o.custom_value)?(r=o.custom_value.call(B,i.find(".customelement").first(),"get"),""===a.data&&void 0!==o.defaultValue&&(a.data=o.defaultValue),void 0===r&&(r=""),a.data!==r&&String(a.data)!==String(r)&&o.custom_value.call(B,i.find(".customelement").first(),"set",a.data)):(""===a.data&&void 0!==o.defaultValue&&(a.data=o.defaultValue),U.jgrid.trim(i.val())!==String(a.data)&&i.val(a.data)),(o=i.closest(".ui-search-input").siblings(".ui-search-oper").children(".soptclass")).data("soper",a.op),o.text(q.operands[a.op]||(P.customSortOperations[a.op]||{}).operand));for(t=0;t<P.colModel.length;t++)e=P.colModel[t].name,l.hasOwnProperty(e)||U(f(e)).val("")}}))})},destroyFilterToolbar:function(){return this.each(function(){var e=this;e.ftoolbar&&(e.triggerToolbar=null,e.clearToolbar=null,e.toggleToolbar=null,e.ftoolbar=!1,U(e.grid.hDiv).find("table thead tr.ui-search-toolbar").remove(),!0===e.p.frozenColumns)&&U(e).jqGrid("destroyFrozenColumns").jqGrid("setFrozenColumns")})},destroyGroupHeader:function(d){return void 0===d&&(d=!0),this.each(function(){var e,t,r=this.grid,a=this.p.colModel,i=U("table.ui-jqgrid-htable thead",r.hDiv);if(r){delete this.grid.groupHeaders,U(this).off(".setGroupHeaders");for(var o=U("<tr>",{role:"row"}).addClass("ui-jqgrid-labels"),l=r.headers,s=0,n=l.length;s<n;s++){t=a[s].hidden?"none":"",t=U(l[s].el).width(l[s].width).css("display",t);try{t.removeAttr("rowSpan")}catch(e){t.attr("rowSpan",1)}o.append(t),0<(e=t.children("span.ui-jqgrid-resize")).length&&(e[0].style.height=""),t.children("div")[0].style.top=""}U(i).children("tr.ui-jqgrid-labels").remove(),U(i).prepend(o),!0===d&&U(this).jqGrid("setGridParam",{groupHeader:null})}})},setGroupHeaders:function(q){return q=U.extend({useColSpanStyle:!1,applyLabelClasses:!0,groupHeaders:[]},q||{}),this.each(function(){this.p.groupHeader=q;var e,t,r,a,i,o,l,s,n,d,c,u=this,h=0,p=u.p,f=p.colModel,g=f.length,m=u.grid.headers,v=U("table.ui-jqgrid-htable",u.grid.hDiv),b=W.isCellClassHidden,y=v.children("thead").children("tr.ui-jqgrid-labels"),w=y.last().addClass("jqg-second-row-header"),j=v.children("thead"),C=v.find(".jqg-first-row-header");void 0===C[0]?C=U("<tr>",{role:"row","aria-hidden":"true"}).addClass("jqg-first-row-header").css("height","auto"):C.empty();for(U(u).prepend(j),r=U("<tr>",{role:"row"}).addClass("ui-jqgrid-labels jqg-third-row-header"),this.grid.groupHeaders=[],e=0;e<g;e++)if(a=m[e].el,i=U(a),t=f[e],c={height:"0",width:m[e].width+"px",display:t.hidden?"none":""},U("<th>",{role:"gridcell"}).css(c).addClass("ui-first-th-"+p.direction+(q.applyLabelClasses?" "+(t.labelClasses||""):"")).appendTo(C),a.style.width="",c=J.call(u,"colHeaders","ui-th-column-header ui-th-"+p.direction+" "+(q.applyLabelClasses&&t.labelClasses||"")),l=function(e,t){for(var r=0;r<t.length;r++)if(t[r].startColumnName===e)return t[r];return 0}(t.name,q.groupHeaders)){for(s=l.numberOfColumns,n=l.titleText,o=d=0;o<s&&e+o<g;o++)f[e+o].hidden||b(f[e+o].classes)||d++;n=U("<th>").addClass(c).addClass(l.className).html(n||"&nbsp;"),0<d&&n.attr("colspan",String(d)),p.headertitles&&n.attr("title",n.text()),0===d&&n.hide(),i.before(n),r.append(a),this.grid.groupHeaders.push({el:n[0],numberOfColumns:l.numberOfColumns,numberOfVisibleColumns:d,title:l.titleText}),h=s-1}else 0===h?q.useColSpanStyle?i.attr("rowspan",y.length+1):(U("<th>").addClass(c).css({display:t.hidden?"none":"","border-top":"0 none"}).insertBefore(i),r.append(a)):(r.append(a),h--),this.grid.groupHeaders.push({el:a,numberOfColumns:1,numberOfVisibleColumns:0,title:""});(j=U(u).children("thead")).prepend(C),r.insertAfter(w),v.prepend(j),U(u).triggerHandler("jqGridAfterSetGroupHeaders")})},getNumberOfFrozenColumns:function(){if(0===this.length)return 0;for(var e=this[0].p.colModel,t=e.length,r=-1,a=0;a<t&&!0===e[a].frozen;a++)r=a;return r+1},setFrozenColumns:function(D){return D=D||{},this.each(function(){var t=this,i=U(t),v=t.p,o=t.grid;if(o&&null!=v&&!0!==v.frozenColumns){var b,e,r,a,l,s,n,y,d,c,u,h,p,f=v.colModel,g=f.length,m=-1,w=!1,j=[],C=$(v.id),q=J.call(t,"states.hover");if(!0!==v.subGrid&&!0!==v.treeGrid&&!v.scroll){for(b=0;b<g&&!0===f[b].frozen;b++)w=!0,m=b,j.push("#jqgh_"+C+"_"+$(f[b].name));if(v.sortable){u=U(o.hDiv).find(".ui-jqgrid-htable .ui-jqgrid-labels");try{u.sortable("destroy")}catch(e){}i.jqGrid("setGridParam",{sortable:{options:{items:0<j.length?">th:not(:has("+j.join(",")+"),:hidden)":">th:not(:hidden)"}}}),i.jqGrid("sortableColumns",u)}0<=m&&w&&(u=v.caption?U(o.cDiv).outerHeight():0,e=U(".ui-jqgrid-htable",v.gView).height(),v.toppager&&(u+=U(o.topDiv).outerHeight()),!0===v.toolbar[0]&&"bottom"!==v.toolbar[1]&&(u+=U(o.uDiv).outerHeight()),o.fhDiv=U("<div style='position:absolute;overflow:hidden;"+("rtl"===v.direction?"right:0;border-top-left-radius:0;":"left:0;border-top-right-radius:0;")+"top:"+u+"px;height:"+e+"px;' class='"+J.call(t,"hDiv","frozen-div ui-jqgrid-hdiv")+"'></div>"),o.fbDiv=U("<div style='position:absolute;overflow:hidden;"+("rtl"===v.direction?"right:0;":"left:0;")+"top:"+(parseInt(u,10)+parseInt(e,10)+1)+"px;overflow:hidden;' class='frozen-bdiv ui-jqgrid-bdiv'></div>"),U(v.gView).append(o.fhDiv),s=(n=U(".ui-jqgrid-htable",v.gView).clone(!0))[0].tHead.rows,v.groupHeader?(U(s[0].cells).filter(":gt("+m+")").remove(),U(s).filter(".jqg-third-row-header").each(function(){U(this).children("th[id]").each(function(){var e=U(this).attr("id");e&&e.substr(0,t.id.length+1)===t.id+"_"&&(e=e.substr(t.id.length+1),v.iColByName[e]>m)&&U(this).remove()})}),a=r=-1,U(s).filter(".jqg-second-row-header").children("th").each(function(){if(l=parseInt(U(this).attr("colspan")||1,10),1<parseInt(U(this).attr("rowspan")||1,10)?(r++,a++):l&&(r+=l,a++),r===m)return!1}),r!==m&&(a=m),U(s).filter(".jqg-second-row-header,.ui-search-toolbar").each(function(){U(this).children(":gt("+a+")").remove()})):U(s).each(function(){U(this).children(":gt("+m+")").remove()}),U(n).width(1),U(o.fhDiv).append(n).scroll(function(){this.scrollLeft=0}),v.footerrow&&(s=U(".ui-jqgrid-bdiv",v.gView).height(),o.fsDiv=U("<div style='position:absolute;"+("rtl"===v.direction?"right:0;":"left:0;")+"top:"+(parseInt(u,10)+parseInt(e,10)+parseInt(s,10)+1)+"px;' class='frozen-sdiv ui-jqgrid-sdiv'></div>"),U(v.gView).append(o.fsDiv),n=U(".ui-jqgrid-ftable",v.gView).clone(!0),U("tr",n).each(function(){U("td:gt("+m+")",this).remove()}),U(n).width(1),U(o.fsDiv).append(n)),U(v.gView).append(o.fbDiv),U(o.bDiv).scroll(function(){U(o.fbDiv).scrollTop(U(this).scrollTop())}),U(o.fbDiv).on("mousewheel.setFrozenColumns DOMMouseScroll.setFrozenColumns",function(e){o.bDiv.scrollTop+=U.jgrid.isFunction(D.mouseWheel)?D.mouseWheel.call(t,e):"mousewheel"===e.type?-e.originalEvent.wheelDelta/10:6*e.originalEvent.detail}),!0===v.hoverrows&&U(v.idSel).off("mouseover.jqGrid mouseout.jqGrid"),y=function(e,t){var r=e.height();1<=Math.abs(r-t)&&0<t&&(e.height(t),r=e.height(),1<=Math.abs(t-r))&&e.height(t+Math.round(t-r))},d=function(e,t){var r=e.width();1<=Math.abs(r-t)&&(e.width(t),r=e.width(),1<=Math.abs(t-r))&&e.width(t+Math.round(t-r))},c=function(e,t,r,a){var i,o,l,s,n,d,c,u,h,p,f,g,m=U(t).position().top;if(null!=e&&0<e.length){if(e[0].scrollTop=t.scrollTop,e.css("rtl"===v.direction?{top:m,right:0}:{top:m,left:0}),l=e.children("table").children("thead").children("tr"),0===(s=U(t).children("div").children("table").children("thead").children("tr")).length&&0<e.children("table").length&&(l=U(e.children("table")[0].rows),s=U(U(t).children("div").children("table")[0].rows)),p=0<(o=Math.min(l.length,s.length))?U(l[0]).position().top:0,f=0<o?U(s[0]).position().top:0,0<=r)for(0<=a&&(o=Math.min(a+1,o)),i=r;i<o;i++)if("none"!==(n=U(s[i])).css("display")&&n.is(":visible")){if(m=n.position().top,c=(d=U(l[i])).position().top,u=n.height(),null!=v.groupHeader&&v.groupHeader.useColSpanStyle)for(g=n[0].cells,b=0;b<g.length;b++)null!=(h=g[b])&&"TH"===h.nodeName.toUpperCase()&&(u=Math.max(u,U(h).height()));y(d,u+(m-f)+(p-c))}y(e,t.clientHeight)}},h={header:u={resizeDiv:!0,resizedRows:{iRowStart:0,iRowEnd:-1}},resizeFooter:!0,body:u},i.on("jqGridAfterGridComplete.setFrozenColumns",function(){U(v.idSel+"_frozen").remove(),U(o.fbDiv).height(o.hDiv.clientHeight);var e,t=U(this).clone(!0),r=t[0].rows,a=i[0].rows;U(r).filter("tr[role=row]").each(function(){U(this.cells).filter("td[role=gridcell]:gt("+m+")").remove()}),o.fbRows=r,t.width(1).attr("id",v.id+"_frozen"),t.appendTo(o.fbDiv),!0===v.hoverrows&&(e=function(e,t,r){U(e)[t](q),U(r[e.rowIndex])[t](q)},U(r).filter(".jqgrow").hover(function(){e(this,"addClass",a)},function(){e(this,"removeClass",a)}),U(a).filter(".jqgrow").hover(function(){e(this,"addClass",r)},function(){e(this,"removeClass",r)})),c(o.fhDiv,o.hDiv,0,-1),c(o.fbDiv,o.bDiv,0,-1),o.sDiv&&c(o.fsDiv,o.sDiv,0,-1)}),p=function(e){U(o.fbDiv).scrollTop(U(o.bDiv).scrollTop()),e.header.resizeDiv&&c(o.fhDiv,o.hDiv,e.header.resizedRows.iRowStart,e.header.resizedRows.iRowEnd),e.body.resizeDiv&&c(o.fbDiv,o.bDiv,e.body.resizedRows.iRowStart,e.body.resizedRows.iRowEnd),e.resizeFooter&&o.sDiv&&e.resizeFooter&&c(o.fsDiv,o.sDiv,0,-1);var t=o.fhDiv[0].clientWidth;e.header.resizeDiv&&null!=o.fhDiv&&1<=o.fhDiv.length&&y(U(o.fhDiv),o.hDiv.clientHeight),e.body.resizeDiv&&null!=o.fbDiv&&0<o.fbDiv.length&&d(U(o.fbDiv),t),e.resizeFooter&&null!=o.fsDiv&&0<=o.fsDiv.length&&d(U(o.fsDiv),t)},U(v.gBox).on("resizestop.setFrozenColumns",function(){setTimeout(function(){p(h)},50)}),i.on("jqGridInlineEditRow.setFrozenColumns jqGridInlineAfterRestoreRow.setFrozenColumns jqGridInlineAfterSaveRow.setFrozenColumns jqGridAfterEditCell.setFrozenColumns jqGridAfterRestoreCell.setFrozenColumns jqGridAfterSaveCell.setFrozenColumns jqGridResizeStop.setFrozenColumns",function(e,t){t=i.jqGrid("getInd",t);p({header:{resizeDiv:!1,resizedRows:{iRowStart:-1,iRowEnd:-1}},resizeFooter:!0,body:{resizeDiv:!0,resizedRows:{iRowStart:t,iRowEnd:t}}})}),i.on("jqGridResizeStop.setFrozenColumns",function(){p(h)}),i.on("jqGridResetFrozenHeights.setFrozenColumns",function(e,t){p(t||h)}),o.hDiv.loading||setTimeout(function(){i.triggerHandler("jqGridAfterGridComplete")},0),v.frozenColumns=!0)}}})},destroyFrozenColumns:function(){return this.each(function(){var t,r,e=U(this),a=this.grid,i=this.p,o=$(i.id);a&&!0===i.frozenColumns&&(U(a.fhDiv).remove(),U(a.fbDiv).off(".setFrozenColumns"),U(a.fbDiv).remove(),a.fhDiv=null,a.fbDiv=null,a.fbRows=null,i.footerrow&&(U(a.fsDiv).remove(),a.fsDiv=null),e.off(".setFrozenColumns"),!0===i.hoverrows&&(r=J.call(this,"states.hover"),e.on("mouseover.jqGrid",function(e){t=U(e.target).closest("tr.jqgrow"),"ui-subgrid"!==U(t).attr("class")&&U(t).addClass(r)}).on("mouseout.jqGrid",function(e){t=U(e.target).closest("tr.jqgrow"),U(t).removeClass(r)})),i.frozenColumns=!1,i.sortable)&&((i=U(a.hDiv).find(".ui-jqgrid-htable .ui-jqgrid-labels")).sortable("destroy"),e.jqGrid("setGridParam",{sortable:{options:{items:">th:not(:has(#jqgh_"+o+"_cb,#jqgh_"+o+"_rn,#jqgh_"+o+"_subgrid),:hidden)"}}}),e.jqGrid("sortableColumns",i))})}})});
//# sourceMappingURL=grid.custom.js.map